psql -U dev -h localhost -d dev

CREATE TABLE visitors (
	id VARCHAR(70) NOT NULL,
    ip_address VARCHAR(50) NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT now(),
    
    PRIMARY KEY (id)
);

CREATE TABLE sports (
	id VARCHAR(70) NOT NULL,
	sport_name VARCHAR(50) NOT NULL,
	league_abrv VARCHAR(10),
	
	PRIMARY KEY (id)
);

CREATE TABLE teams (
	id VARCHAR(70) NOT NULL,
	team_name VARCHAR(100) NOT NULL,
	sport_id VARCHAR(70) NOT NULL,

	PRIMARY KEY (id),
	FOREIGN KEY (sport_id) REFERENCES sports (id)
);

CREATE TABLE matches (
	id VARCHAR(70) NOT NULL,
	sport_league_abbrv VARCHAR(10) NOT NULL,
	visitor_team_id VARCHAR(70) NOT NULL,
	home_team_id VARCHAR(70) NOT NULL,
	match_start_time TIMESTAMP NOT NULL,
	
	PRIMARY KEY (id),
	FOREIGN KEY (visitor_team_id) REFERENCES teams (id),
	FOREIGN KEY (home_team_id) REFERENCES teams (id)
);

CREATE INDEX matches_league_abbrv_idx ON matches (sport_league_abbrv);
CREATE INDEX matches_match_time_idx ON matches (match_start_time);

CREATE TABLE predictions (
	visitor_id VARCHAR(70) NOT NULL,
	match_id VARCHAR(70) NOT NULL,
	victorious_team_id VARCHAR(70) NOT NULL,
	visitor_team_score INTEGER,
	home_team_score INTEGER,
	created_at TIMESTAMP NOT NULL DEFAULT now(),
	
	PRIMARY KEY (visitor_id,match_id),
	FOREIGN KEY (visitor_id) REFERENCES visitors (id),
	FOREIGN KEY (match_id) REFERENCES matches (id),
	FOREIGN KEY (victorious_team_id) REFERENCES teams (id)
);
CREATE INDEX predictions_match_id_idx ON predictions (match_id);


